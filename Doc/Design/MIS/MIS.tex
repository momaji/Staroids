\documentclass[12pt]{article}

%============================
%============================
% This document was created by all members of the Staroids team equally
%============================
%============================

\usepackage{graphicx}
\usepackage{paralist}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{hhline}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{tabularx}


\oddsidemargin 0mm
\evensidemargin 0mm
\textwidth 160mm
\textheight 200mm
\renewcommand\baselinestretch{1.0}

\pagestyle {plain}
\pagenumbering{arabic}

\newcounter{stepnum}

%% Comments

\usepackage{color}

\newcommand{\wss}[1]{\authornote{blue}{SS}{#1}}
\newcommand{\means}{\Rightarrow}
\newcommand{\s}{\mbox{ }}
\newcommand{\m}[1]{\mbox{#1}}

\title{Staroids, Module Interface Specification}
\author{Team 20, Staroids
  \\ Moziah San Vicente, 400091284, sanvicem
  \\ Eoin Lynagh, 400067675, lynaghe
  \\ Jason Nagy, 400055130, nagyj2
}

\begin{document}

\maketitle

\begin{table}[bp]
\caption{\bf Revision History}
\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Nov 06/18 & 0.1 & Added basic information to template\\
Nov 07/18 & 0.2 & Added Head module specification\\
Nov 08/18 & 0.3 & Added all module specifications\\
Nov 09/18 & 0.35 & Tidied up\\
Nov 09/18 & 0.5 & Finished Sound, Utilities, Head and Game State MIS\\
Nov 09/18 & 0.6 & Fixed formatting\\
Nov 09/18 & 1.0 & Added all functions, state variables, state invariants, and defintions. Completed rough draft of MIS\\
Nov 09/18 & 1.1 & Fixed Spelling and Grammar\\
\bottomrule
\end{tabularx}
\end{table}

The following is a series of MISes for the modules that comprise the Staroids game

%==================================================
\newpage

\section*{Utilities Module}

\subsection*{Template Module}

Utilities

\subsection*{Uses}

CVS from Browser (Playing screen)\\
CTX from CVS (Screen coordinate system)\\
FONTSTYLE from Browser (Available fonts for printing)\\

\subsection*{Syntax}

\subsubsection*{Exported Types}

FPS=30\\
SHIP\_SIZE=30\\
TURN\_SPEED=180\\
SHIP\_THRUST=0.2\\
SHIP\_BREAK=0.98\\
MIN\_SPEED=0.1\\
MAX\_SPEED=20\\
MAX\_ACC=2\\
CVS\_WIDTH=780\\
CVS\_HEIGHT=620\\
BULLET\_EXTRA=5\\
KILLABLE=\{True,False\}\\
MAX\_ASTEROIDS=2\\
TEST=\{True,False\}\\
ALIEN\_SPAWN=700\\
KeyCode=\{UP,DOWN,RIGHT,LEFT,SPACE,M,P,R\}\\
EPOCH=1\\
Key=?\\
Text=?\\
Game=?\\

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |} %Key object
\hline
\textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\hline
Key &  & Key & ~\\
\hline
isDown & KeyCode & $\mathbb{N}$ & ~\\
\hline
onKeydown & KeyCode & $\mathbb{N}$ & ~\\
\hline
onKeyup & KeyCode &  & ~\\
\hline
\end{tabular}

\subsection*{Semantics}

\subsubsection*{State Variables}

$d$: sequence of $\mathbb{N}$\\

\subsubsection*{State Invariant}

$\forall (c : \mathbb{N} | c \in d : c > 0)$

\subsubsection*{Assumptions}

\begin{itemize}
    \item Only known keys (as defined by KeyCode) will be put into the Key object as events to be processed.
\end{itemize}

\subsubsection*{Access Routine Semantics}

Key():
\begin{itemize}
    \item transition: $d :=$ seq of KeyCode
    \item output: $out := Key$
    \item exception: None
\end{itemize}

\noindent isDown(e):
\begin{itemize}
    \item output: $e \in d \Rightarrow true \land e \notin d \Rightarrow false$
    \item exception: None
\end{itemize}

\noindent onKeydown(e):
\begin{itemize}
    \item transition: $d[e] = \mbox{EPOCH}$
    \item exception: None
\end{itemize}

\noindent onKeyup(e):
\begin{itemize}
    \item transition: $d := d \setminus d[e]$
    \item exception: None
\end{itemize}


\newpage %Text Object

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |}
\hline
\textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\hline
TEXT & CTX, FONTSTYLE & TEXT & ~\\
\hline
norm & String$, \mathbb{Z}, \mathbb{Z}$ &  & ~\\
\hline
emph & String$, \mathbb{Z}, \mathbb{Z}$ &  & ~\\
\hline
\end{tabular}

\subsection*{Semantics}

\subsubsection*{State Variables}

$cvs$: CTX\\
$fnt$: FONTSTYLE\\

\subsubsection*{State Invariant}

None

\subsubsection*{Assumptions}

\begin{itemize}
  \item Before the Text object is used, the initialization function must be run first.
\end{itemize}

\subsubsection*{Access Routine Semantics}

norm($Str,x,y$):
\begin{itemize}
    \item transition: Displays $Str$ to $cvs$ at location $(x,y)$ in standard font.
    \item exception: None
\end{itemize}

\noindent emph($Str,x,y$):
\begin{itemize}
    \item transition: Displays $Str$ to $cvs$ at location $(x,y)$ in emphasized font.
    \item exception: None
\end{itemize}

\newpage %Game

\begin{tabular}{| l | l | l | l |}
\hline
\textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\hline
Game &  & ~\\
\hline
addScore & $\mathbb{Z}$ &  & ~\\
\hline
addSprites & OBJECT &  & ~\\
\hline
subLives & $\mathbb{Z}$ &  & ~\\
\hline
subSprites & OBJECT &  & ~\\
\hline
getScore &  & $\mathbb{N}$  & ~\\
\hline
getLives &  & $\mathbb{N}$  & ~\\
\hline
getLevel &  & $\mathbb{N}$  & ~\\
\hline
getAsteroids &  & $\mathbb{N}$  & ~\\
\hline
getWidth &  & $\mathbb{N}$  & ~\\
\hline
getHeight &  & $\mathbb{N}$  & ~\\
\hline
getCvs &  & CVS  & ~\\
\hline
getCtx &  & CTX  & ~\\
\hline
getSprites &  & sequence of OBJECT  & ~\\
\hline
getPlayer &  & PLAYER  & ~\\
\hline
getAlien &  & ALIEN  & ~\\
\hline
getText &  & TEXT  & ~\\
\hline
getSound &  & SOUND  & ~\\
\hline
getPaused &  & $\mathbb{B}$  & ~\\
\hline
setScore & $\mathbb{N}$ &  & ~\\
\hline
setLives & $\mathbb{N}$ &  & ~\\
\hline
setLevel & $\mathbb{N}$ &  & ~\\
\hline
setAsteroids & $\mathbb{N}$ &  & ~\\
\hline
setWidth & $\mathbb{N}$ &  & ~\\
\hline
setHeight & $\mathbb{N}$ &  & ~\\
\hline
setCvs & CVS &  & ~\\
\hline
setCtx & CTX &  & ~\\
\hline
setSprites & sequence of OBJECT &  & ~\\
\hline
setPlayer & PLAYER &  & ~\\
\hline
setAlien & ALIEN &  & ~\\
\hline
setText & TEXT &  & ~\\
\hline
setSound & SOUND &  & ~\\
\hline
setPaused & $\mathbb{B}$ &  & ~\\
\hline
reduceCounter & $String, \mathbb{Z}, \mathbb{Z}$ &  & ~\\
\hline
resetMute &  &  & ~\\
\hline
resetPause &  &  & ~\\
\hline
drawLives &  &  & ~\\
\hline
\end{tabular}

\subsection*{Semantics}

\subsubsection*{State Variables}

$score$: $\mathbb{N}$\\
$lives$: $\mathbb{N}$\\
$level$: $\mathbb{N}$\\
$asteroids$: $\mathbb{N}$\\
$width$: $\mathbb{N}$\\
$height$: $\mathbb{N}$\\
$cvs$: CVS\\
$ctx$: CTX\\
$sprites$: sequence of OBJECT\\
$player$: PLAYER\\
$alien$: ALIEN\\
$text$: TEXT\\
$sound$: SOUND\\
$paused$: $\mathbb{B}$\\
$muteSound$: $\mathbb{N}$\\
$pauseGame$: $\mathbb{N}$\\

\subsubsection*{State Invariant}

None

\subsubsection*{Assumptions}

%\begin{itemize}
%
%\end{itemize}

None

\subsubsection*{Access Routine Semantics}

Game():
\begin{itemize}
    \item transition: $score = 0 \land lives = 3 \land level = 0 \land asteroids = 2 \land width = 780 \land height = 620 \land cvs = \mbox{CVS} \land ctx = \mbox{CTX} \land paused = false \land sprites = \mbox{seq. of OBJECT} \land muteSound = FPS \land pauseGame = FPS$
    \item exception: None
\end{itemize}

\noindent getScore():
\begin{itemize}
    \item output: $out := score$
    \item exception: None
\end{itemize}

\noindent getLives():
\begin{itemize}
    \item output: $out := lives$
    \item exception: None
\end{itemize}

\noindent getLevel():
\begin{itemize}
    \item output: $out := level$
    \item exception: None
\end{itemize}

\noindent getAsteroids():
\begin{itemize}
    \item output: $out := asteroids$
    \item exception: None
\end{itemize}

\noindent getWidth():
\begin{itemize}
    \item output: $out := width$
    \item exception: None
\end{itemize}

\indent getHeight():
\begin{itemize}
    \item output: $out := height$
    \item exception: None
\end{itemize}

\noindent getCvs():
\begin{itemize}
    \item output: $out := cvs$
    \item exception: None
\end{itemize}

\noindent getCtx():
\begin{itemize}
    \item output: $out := ctx$
    \item exception: None
\end{itemize}

\noindent getSprites():
\begin{itemize}
    \item output: $out := sprites$
    \item exception: None
\end{itemize}

\noindent getPlayer():
\begin{itemize}
    \item output: $out := player$
    \item exception: None
\end{itemize}

\noindent getAlien():
\begin{itemize}
    \item output: $out := alien$
    \item exception: None
\end{itemize}

\noindent getText():
\begin{itemize}
    \item output: $out := text$
    \item exception: None
\end{itemize}

\noindent getSound():
\begin{itemize}
    \item output: $out := sound$
    \item exception: None
\end{itemize}

\noindent getPaused():
\begin{itemize}
    \item output: $out := paused$
    \item exception: None
\end{itemize}

\noindent setScore(s):
\begin{itemize}
    \item transition: $score = s$
    \item exception: None
\end{itemize}

\noindent setLives(l):
\begin{itemize}
    \item transition: $lives = l$
    \item exception: None
\end{itemize}

\noindent setLevel(l):
\begin{itemize}
    \item transition: $level = l$
    \item exception: None
\end{itemize}

\noindent setAsteroids(a):
\begin{itemize}
    \item transition: $asteroids = a$
    \item exception: None
\end{itemize}

\noindent setWidth(w):
\begin{itemize}
    \item transition: $width = w$
    \item exception: None
\end{itemize}

\noindent getHeight(h):
\begin{itemize}
    \item transition: $height = h$
    \item exception: None
\end{itemize}

\noindent setCvs(c):
\begin{itemize}
    \item transition: $cvs = c$
    \item exception: None
\end{itemize}

\noindent setCtx(c):
\begin{itemize}
    \item transition: $cyx = c$
    \item exception: None
\end{itemize}

\noindent setSprites(s):
\begin{itemize}
    \item transition: $sprites = s$
    \item exception: None
\end{itemize}

\noindent setPlayer(p):
\begin{itemize}
    \item transition: $player = p$
    \item exception: None
\end{itemize}

\noindent setAlien():
\begin{itemize}
    \item transition: $alien = a$
    \item exception: None
\end{itemize}

\noindent setText(t):
\begin{itemize}
    \item transition: $text = t$
    \item exception: None
\end{itemize}

\noindent setSound(s):
\begin{itemize}
    \item transition: $sound = s$
    \item exception: None
\end{itemize}

\noindent setPaused(b):
\begin{itemize}
    \item transition: $paused = b$
    \item exception: None
\end{itemize}

\noindent reduceCounter():
\begin{itemize}
    \item transition: $ muteSound := muteSound - 1 \land pauseGame := pauseGame - 1 $
    \item exception: None
\end{itemize}

\noindent resetMute():
\begin{itemize}
    \item transition: $ muteSound = FPS $
    \item exception: None
\end{itemize}

\noindent resetPause():
\begin{itemize}
    \item transition: $ pauseGame = FPS $
    \item exception: None
\end{itemize}

\noindent drawLives():
\begin{itemize}
    \item transition: Draws $lives$ amount of triangular ships to the top left corner of screen to represent player amount of lives left.
    \item exception: None
\end{itemize}

\noindent addScore(amount):
\begin{itemize}
    \item transition: $ score = score + amount $
    \item exception: None
\end{itemize}

\noindent addSprite(obj):
\begin{itemize}
    \item transition: $ sprites = sprites || obj $
    \item exception: None
\end{itemize}

\noindent subLives(obj):
\begin{itemize}
    \item transition: $ lives = lives - 1 $
    \item exception: None
\end{itemize}

\noindent subSprite(obj):
\begin{itemize}
    \item transition: $ sprites = sprites \setminus obj $
    \item exception: None
\end{itemize}

%==================================================
\newpage

\section*{Sound Module}

\subsection*{Uses}

AUDIO from .wav sound files\\
Within the AUDIO class, there are specific sounds\\
\begin{itemize}
  \item LASER for shooting projectiles\\
  \item BRAKE for the player ship braking\\
  \item EXPLOSION for the destruction\\
\end{itemize}

\subsection*{Syntax}

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    Sound & ~ & AUDIO & ~\\
    \hline
    play & AUDIO & ~ & ~\\
    \hline
    isPlay & AUDIO & $\mathbb{B}$ & ~\\
    \hline
    pause & AUDIO & ~ & ~\\
    \hline
    unpause & AUDIO & ~ & ~\\
    \hline
    stop & AUDIO & ~ & ~\\
    \hline
    mute & ~ & ~ & ~\\
    \hline
    unmute & ~ & ~ & ~\\
    \hline
    toggle & ~ & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

$sounds$ = $\{LASER,BRAKE,EXPLOSION\}$
$muted$ = $\mathbb{B}$

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
    \item The constructor is called before other accesses
    \item The sound files are in the correct directory for the projectiles
    \item The sound files have the same name as expected.
\end{itemize}

\subsubsection* {Access Routine Semantics}

\noindent Sound():
\begin{itemize}
  \item transition: $muted := false$
  \item exception: None
  %ask about the Audio objects
\end{itemize}

\noindent play(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item transition: $\lnot muted \Rightarrow Play(x)$
  \item exception: None
\end{itemize}

\noindent isPlay(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item output: Boolean to whether sound x is playing or not
  \item exception: None
\end{itemize}

\noindent pause(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item transition: $pauseSound(x)$
  \item exception: None
\end{itemize}

\noindent unpause(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item transition: $unpauseSound(x)$
  \item exception: None
\end{itemize}

\noindent stop(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item transition: $stopSound(x)$
  \item exception: None
\end{itemize}

\noindent mute(x):
\begin{itemize}
  \item input: $x \in \mbox{sound}$
  \item transition: $muted := true$
  \item exception: None
\end{itemize}

\noindent unmute(x):
\begin{itemize}
  \item input: $x \in \mbox{Sound}$
  \item transition: $muted := false$
  \item exception: None
\end{itemize}

\noindent toggle():
\begin{itemize}
  \item transition: $muted = true \Rightarrow muted := false \lor muted = false \Rightarrow muted := true$
  \item exception: None
\end{itemize}

%===================================================
\newpage

\section*{Head Module}

\subsection*{Uses}

FILE from modules (Takes the source file):
\begin{itemize}
  \item Utilities\\
  \item Sound\\
  \item GameObject\\
  \item GameState\\
\end{itemize}

\subsubsection*{Exported Constants}

None

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    dynamicallyLoadScript & FILE & ~ & ~\\
    \hline

\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

None

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
    \item The files are named the same way that the module expects
\end{itemize}

\subsubsection* {Access Routine Semantics}

\noindent dynamicallyLoadScript(x):
\begin{itemize}
    \item input: $x \in \mbox{FILE}$
    \item transition: Appends $x$ to the current file
    \item output: $out := Head$
    \item exception: None
\end{itemize}


%===================================================
\newpage

\section*{GameObject Module}

\subsection*{Template Module}

GameObject

\subsection*{Uses}

CVS from Browser (Playing screen)\\
CTX from CVS (Screen coordinate system)\\
Utilities\\
Sound\\

\subsection*{Syntax}

\subsubsection*{Exported Types}

GameObject=?
Player=?
Bullet=?
Alien=?
AlienBullet=?
Asteroid=?

\subsubsection*{Exported Constants}

None

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    GameObject & ~ & GameObject & ~\\
    \hline
    getX & ~ & $\mathbb{Z}$ & ~\\
    \hline
    getY & ~ & $\mathbb{Z}$ & ~\\
    \hline
    getHeading & ~ & $\mathbb{R}$ & ~\\
    \hline
    getActivity & ~ & $\mathbb{B}$ & ~\\
    \hline
    getRadius & ~ & $\mathbb{Z}$ & ~\\
    \hline
    getVel & ~ & $\mathbb{R}$ & ~\\
    \hline
    getCtx & ~ & CTX & ~\\
    \hline
    getName & ~ & String & ~\\
    \hline
    setX & $\mathbb{Z}$ & ~ & ~\\
    \hline
    setY & $\mathbb{Z}$ & ~ & ~\\
    \hline
    setActivity & $\mathbb{B}$ & ~ & ~\\
    \hline
    update & ~ & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

$name$: String\\
$x$: $\mathbb{R}$\\
$y$: $\mathbb{R}$\\
$velX$: $\mathbb{R}$\\
$velY$: $\mathbb{R}$\\
$accX$: $\mathbb{R}$\\
$accY$: $\mathbb{R}$\\
$rot$: $\mathbb{R}$\\
$a$: $\mathbb{R}$\\
$r$: $\mathbb{N}$\\
$visible$: $\mathbb{B}$\\
$ctx$: CTX\\

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other GameObject method is called.
\end{itemize}

GameObject(name):
\begin{itemize}
    \item transition: $name, x, y, rot, a, visible, vel, acc, r, ctx = \mbox{name}, 0, 0, 0, 0, false, (0,0), (0,0), 0, \mbox{CTX}$
    \item output: $out := GameObject$
    \item exception: None
\end{itemize}

\noindent getX():
\begin{itemize}
    \item output: $out := x$
    \item exception: None
\end{itemize}

\noindent getY():
\begin{itemize}
    \item output: $out := y$
    \item exception: None
\end{itemize}

\noindent getHeading():
\begin{itemize}
    \item output: $out := a$
    \item exception: None
\end{itemize}

\noindent getActivity():
\begin{itemize}
    \item output: $out := visible$
    \item exception: None
\end{itemize}

\noindent getRadius():
\begin{itemize}
    \item output: $out := r$
    \item exception: None
\end{itemize}

\noindent getVel():
\begin{itemize}
    \item output: $out := vel$
    \item exception: None
\end{itemize}

\noindent getAcc():
\begin{itemize}
    \item output: $out := acc$
    \item exception: None
\end{itemize}

\noindent getCtx():
\begin{itemize}
    \item output: $out := ctx$
    \item exception: None
\end{itemize}

\noindent getName():
\begin{itemize}
    \item output: $out := name$
    \item exception: None
\end{itemize}

\noindent setX(x):
\begin{itemize}
    \item input: $in := x \in \mathbb{Z}$
    \item exception: None
\end{itemize}

\noindent setY(y):
\begin{itemize}
    \item input: $in := x \in \mathbb{Z}$
    \item exception: None
\end{itemize}

\noindent setActivity(activity):
\begin{itemize}
    \item input: $in := x \in \mathbb{B}$
    \item exception: None
\end{itemize}

\noindent update():
\begin{itemize}
    \item transition: Runs the object's update function. This includes the draw, action, reset, move, collide and interact. This is run by all inherit classes and not the base GameObject class.
    \item exception: None
\end{itemize}

%===================================================
\newpage

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    Player & ~ & Player & ~\\
    \hline
    interact & KeyCode & ~ & ~\\
    \hline
    move & ~ & ~ & exclusion\\
    \hline
    draw & ~ & CVS & ~\\
    \hline
    action & ~ & ~ & ~\\
    \hline
    collide & ~ & ~ & ~\\
    \hline
    collideOffshoot & ~ & ~ & ~\\
    \hline
    die & ~ & ~ & ~\\
    \hline
    reset & ~ & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

All GameObject state variables
$thrust$: $\mathbb{B}$\\
$fire$: $\mathbb{B}$\\
$turn$: String\\
$airbrake$: $\mathbb{B}$\\
$bulletCountdown$: $\mathbb{Z}$

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other Player method is called.
\end{itemize}

\subsubsection*{Uses}
GameObject

Player():
\begin{itemize}
    \item inherit: GameObject $\Rightarrow$ All state variables and methods
    \item transition: $ fire, thrust, turn, airbrake, bulletCountDown vel(x,y), acc(x,y), r = false, false, false, \mbox{FPS}/2, (0,0), (0,0), \mbox{SHIP\_SIZE/2}$
    \item output: $out := Player$
    \item exception: None
\end{itemize}

\noindent interact(e):
\begin{itemize}
  \item input: $e \in \mbox{KeyCode}$
  \item transition: $e = \mbox{UP} \Rightarrow thrust = true \land e = \mbox{SPACE} \Rightarrow fire = true \land e = \mbox{LEFT} \Rightarrow turn = \mbox{left} \land e = \mbox{RIGHT} \Rightarrow turn = \mbox{right} \land e = \mbox{DOWN} \Rightarrow airbrake = true$
  \item exception: None
\end{itemize}

\noindent move():
\begin{itemize}
  \item input: $thrust, turn := true \lor false, left \lor right$
  \item transition: $thrust = true \Rightarrow accX += \mbox{SHIP\_THRUST} * cos(a)/\mbox{FPS} \land accY += \mbox{SHIP\_THRUST} * sin(a)/\mbox{FPS} \land velX += accX \land velY += accY, thrust = false \Rightarrow \mbox{DO NOTHING}, turn = right \Rightarrow rot = -\mbox{TURN\_SPEED}/180*\mbox{PI}/\mbox{FPS}, turn = left \Rightarrow rot =  \mbox{TURN\_SPEED}/180*\mbox{PI}/\mbox{FPS}, turn \lnot (right \lor left) \Rightarrow rot = 0,   space, left, right, down := thrust = true, fire = true, turn = left, turn = right, airbrake = true$
  \item exception: $vel.x >= \mbox{MAX\_SPEED} \Rightarrow \mbox{DO NOT TRANSITION THRUST AND DECREMENT VELOCITY UNTIL IT IS BELOW MAX SPEED}, vel.y >= max \Rightarrow \mbox{DO NOT TRANSITION THRUST AND DECREMENT VELOCITY UNTIL IT IS BELOW MAX SPEED}$
  \item exclusion: $(x < 0 \Rightarrow x = CVS\_WIDTH) \lor (y < 0 \Rightarrow y = CVS\_HEIGHT) \lor (x > CVS\_WIDTH \Rightarrow x = 0) \lor (y > CVS\_HEIGHT \Rightarrow y = 0)$
\end{itemize}

\noindent draw():
\begin{itemize}
  \item input: Player
  \item transition: draws shape of player ship onto canvas including a thruster image if the ship is being thrusted.
  \item exception: None
\end{itemize}

\noindent action():
\begin{itemize}
  \item input: fire and bullet countdown
  \item transition: if fire is set to true then a new bullet object is created the bullet sound is played and the and the bullet countdown is set to FPS/1.25. The bullet is also added to the sprite array, and the player object is passed through to the bullet in order for it to get its relative velocity and location from.
  \item exception: None
\end{itemize}

\noindent collide():
\begin{itemize}
  \item input: none
  \item transition: Checks the sprite array from Game in utilities module to see if any asteroid, alien, or alienBullet objects are overlapping areas with the player and if so it will kill the player.
  \item exception: None
\end{itemize}

\noindent collideOffshoot():
\begin{itemize}
  \item input: none
  \item transition: Same as collide but recursively goes through the asteroids children to check them as well.
  \item exception: None
\end{itemize}

\noindent die():
\begin{itemize}
  \item input: none
  \item transition: when player dies due to collision the game lives are decremented by one, the player is deactivated and the vel and acc in both the x and y directions are set back to zero.
  \item exception: None
\end{itemize}

\noindent reset():
\begin{itemize}
  \item input: none
  \item transition: $fire, thrust, turn, airbrake, bulletCountdown := false, false, false, false, bulletCountdown - 1$
  \item exception: None
\end{itemize}

\newpage

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    Bullet & Player & Bullet & ~\\
    \hline
    action & ~ & ~ & ~\\
    \hline
    move & ~ & ~ & exclusion\\
    \hline
    draw & ~ & ~ & ~\\
    \hline
    collide & ~ & ~ & ~\\
    \hline
    collideOffshoot & seq of OBJECT & ~ & ~\\
    \hline
    getTimeout & ~ & $\mathbb{Z}$ & ~\\
    \hline
    setTimeout & $\mathbb{Z}$ & ~ & ~\\
    \hline
    
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

All GameObject state variables\\
$timeOut$: $\mathbb{Z}$\\

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other Bullet method is called.
\end{itemize}

\subsubsection*{Uses}
GameObject

Bullet(p):
\begin{itemize}
    \item inherit: GameObject $\Rightarrow$ All state variables and methods
    \item transition: $timeOut, x, y, r, velX, velY = 200, p.getX + 4/3 * p.getR * cos(p.getHeading, p.getY - 4/3 * p.getR * sin(p.getHeading, 1, p.velX + \mbox{BULLET\_EXTRA} * cos(p.getHeading, p.velY + \mbox{BULLET\_EXTRA} * -sin(p.getHeading) $
    \item output: $out := Bullet$
    \item exception: None
\end{itemize}

\noindent action():
\begin{itemize}
    \item transition: $timeOut <=0 \Rightarrow this.deactivate \land Game.subSprites(this) \land timeOut > 0 timeOut  - 1$
\end{itemize}

\noindent move()
\begin{itemize}
    \item transition: $x := x + velX \land y := y + velY$
    \item exclusion: $(x < 0 \Rightarrow x = CVS\_WIDTH) \lor (y < 0 \Rightarrow y = CVS\_HEIGHT) \lor (x > CVS\_WIDTH \Rightarrow x = 0) \lor (y > CVS\_HEIGHT \Rightarrow y = 0)$
\end{itemize}

\noindent draw():
\begin{itemize}
    \item transition: If the sprite is active, it draws a circle with radius 1 at the x and y location of the bullet.
\end{itemize}

\noindent collide():
\begin{itemize}
    \item transition: If both the sprite its colliding with and itself are active, then if they collide, and the other object is an alien or asteroid, it destroys the asteroid/alien and the bullet then increases score.
\end{itemize}

\noindent collideOffshoot():
\begin{itemize}
    \item transition: Recursive version of collide for checking that its not colliding with asteroid children.
\end{itemize}
\newpage

\noindent die():
\begin{itemize}
    \item transition: $deactivate$
\end{itemize}

\noindent getTimeout():
\begin{itemize}
    \item output = $out := this.timeOut$
\end{itemize}

\noindent setTimeout(life):
\begin{itemize}
    \item input = $life \in \mathbb{Z}$
    \item transition: $timeOut := life$
\end{itemize}

\newpage

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    Alien & CTX & Alien & ~\\
    \hline
    draw & ~ & ~ & ~\\
    \hline
    move & ~ & ~ & exclusion\\
    \hline
    action & ~ & ~ & ~\\
    \hline
    collide & ~ & ~ & ~\\
    \hline
    collideOffshoot & ~ & ~ & ~\\
    \hline
    die & ~ & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

All GameObject state variables\\
$timeSpawn$: $\mathbb{N}$\\
$timeOut$: $\mathbb{N}$\\
$xOrY$: $\mathbb{B}$\\
$lOrR$: $\mathbb{B}$\\
$acc$: sequence of $\mathbb{N}$\\

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other Alien method is called.
\end{itemize}

\subsubsection*{Uses}
GameObject

Alien():
\begin{itemize}
  \item inherit: GameObject $\Rightarrow$ All state variables and methods
  \item transition: $ timeSpawn, timeOut, xOrY, lOrR, acc, r = \mbox{ALIEN\_SPAWN}, 50, true, true, (0,0), 12.5 $\\
  \item output: $out := Alien$
  \item exception: None
\end{itemize}

\noindent draw():
\begin{itemize}
  \item transition: If $visible = true$, it draws a square at $(x,y)$ every frame to $ctx$.
  \item exception: None
\end{itemize}

\noindent move():
\begin{itemize}
  \item transition: $vel$ is added to $x$ and $y$. This moves the Alien on the screen.
  \item exclusion: $(x < 0 \Rightarrow x = CVS\_WIDTH) \lor (y < 0 \Rightarrow y = CVS\_HEIGHT) \lor (x > CVS\_WIDTH \Rightarrow x = 0) \lor (y > CVS\_HEIGHT \Rightarrow y = 0)$
\end{itemize}

\noindent action():
\begin{itemize}
  \item transition: The alien counts down until another AlienBullet is fired. $vel$ is also adjusted to create a sinusoidal path for the Alien to move through.
  \item exception: None
\end{itemize}

\noindent collide():
\begin{itemize}
  \item transition: Detects if a PLAYER, BULLET, or ASTEROID is within $r$ pixels of the alien. If so, the alien executes die()
  \item exception: None
\end{itemize}

\noindent collideOffshoot(x):
\begin{itemize}
  \item input: $x$ = sequence of OBJECT
  \item transition: Detects if a PLAYER, BULLET, or ASTEROID is within $r$ pixels of the alien. If so, the alien executes die(). If any object has children, collideOffshoot() is called again with those children as x
  \item exception: None
\end{itemize}

\noindent die():
\begin{itemize}
  \item transition: Makes the Alien invisible and randomizes its location on $cvs$. $timeSpawn$ is reset to ALIEN\_SPAWN, $timeOut$ to 50, $xOrY$ and $lOrR$ to 1 or 0 and true or false randomly, respectfully.
  \item exception: None
\end{itemize}

\newpage

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    AlienBullet & ~ & AlienBullet & ~\\
    \hline
    action & ~ & ~ & ~\\
    \hline
    move & ~ & ~ & exclusion\\
    \hline
    draw & ~ & ~ & ~\\
    \hline
    collide & ~ & ~ & ~\\
    \hline
    collideOffshoot & astChildren & ~ & ~\\
    \hline
    die & ~ & ~ & ~\\
    \hline
    getTimeout & ~ & timeout & ~\\
    \hline
    setTimeout & life & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

All GameObject state variables\\
$timeOut$: $\mathbb{Z}$\\

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other AlienBullet method is called.
\end{itemize}

\subsubsection*{Uses}
GameObject

AlienBullet(a):
\begin{itemize}
    \item inherit: GameObject $\Rightarrow$ All state variables and methods
    \item transition: $ timeOut, vel, x, y, r, velx, vely = 200, {}, getX(a), getY(a), 2, random(-3..3), number so that |velX|^2 + |velY|^2 = 3$
    \item output: $out := AlienBullet$
    \item exception: None
\end{itemize}

\noindent action():
\begin{itemize}
    \item transition: $timeOut <=0 \Rightarrow deactivate() \land Game.subSprites(this) \land timeOut > 0 \Rightarrow timeOut := timeOut - 1$
\end{itemize}

\noindent move()
\begin{itemize}
    \item transition: $x := x + velX \land y := y + velY$
    \item exclusion: $(x < 0 \Rightarrow x = CVS\_WIDTH) \lor (y < 0 \Rightarrow y = CVS\_HEIGHT) \lor (x > CVS\_WIDTH \Rightarrow x = 0) \lor (y > CVS\_HEIGHT \Rightarrow y = 0)$
\end{itemize}

\noindent draw():
\begin{itemize}
    \item transition: if the sprite is active, it draws a red circle with radius 2 at the x and y location of the bullet.
\end{itemize}

\noindent collide():
\begin{itemize}
    \item transition: if both the sprite its colliding with and itself are active, then if they collide, and the other object is a player or asteroid, it destroys the player/asteroid and the bullet.
\end{itemize}

\noindent collideOffshoot():
\begin{itemize}
    \item transition: recursive version of collide for checking that its not colliding with asteroid children.
\end{itemize}

\noindent die():
\begin{itemize}
    \item transition: $deactivate$
\end{itemize}

\noindent getTimeout():
\begin{itemize}
    \item output = $out := timeOut$
\end{itemize}

\noindent setTimeout(life):
\begin{itemize}
    \item input = $life \in \mathbb{Z}$
    \item transition: $timeOut := life$
\end{itemize}

\newpage

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    Asteroid & ~ & Asteroid & ~\\
    \hline
    Draw & ~ & CVS & ~\\
    \hline
    move & ~ & ~ & exclusion\\
    \hline
    action & ~ & ~ & ~\\
    \hline
    die & ~ & Asteroid & ~\\
    \hline
    pass & ~ & Asteroid & ~\\
    \hline
    isDead & ~ & $\mathbb{B}$ & ~\\
    \hline
    getChildren & ~ & Asteroid & ~\\
    \hline
    getScale & ~ & $\mathbb{N}$ & ~\\
    \hline
    setChildren & children & ~ & ~\\
    \hline
    setScale & scale & ~ & ~\\
    \hline
    add & children & ~ & ~\\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

All GameObject state variables
$scale$: $mathbb{N}$\\
$children$: sequence of Asteroid\\

\subsubsection* {State Invariant}

None

\subsubsection* {Assumptions}

\begin{itemize}
  \item The constructor is called before any other Alien method is called.
\end{itemize}

\subsubsection*{Uses}

The JavaScript Math library for random, round and other functions.\\
GameObject\\

Asteroid(c,s):
\begin{itemize}
    \item inherit: GameObject $\Rightarrow$ All state variables and methods
    \item input: $c \in \mbox{CTX}, s \in \mathbb{Z}$
    \item transition: $ x, y, scale, r, children, velX, velY = random(0...CVS\_WIDTH), random(0...CVS\_HEIGHT), scale, 5*scale, [], random(-1...1) * 3, random(-1...1) * 3$
    \item output: $out := Asteroid$
    \item exception: None
\end{itemize}

\noindent draw():
\begin{itemize}
  \item transition: If $visible = true$, it draws a circle at $(x,y)$ every frame to $ctx$. If $visible = false$, it draws all asteroids in $children$
  \item exception: None
\end{itemize}

\noindent move():
\begin{itemize}
  \item transition: $x := x + velX \land y := y + velY$
  \item exclusion: $(x < 0 \Rightarrow x = CVS\_WIDTH) \lor (y < 0 \Rightarrow y = CVS\_HEIGHT) \lor (x > CVS\_WIDTH \Rightarrow x = 0) \lor (y > CVS\_HEIGHT \Rightarrow y = 0)$
  \item exception: None
\end{itemize}

\noindent action():
\begin{itemize}
    \item transition: For testing, it checks if keys are being pressed each frame, and if they are, asteroids are destroyed, corresponding to the test key.
    \item exception: None
\end{itemize}

\noindent die():
\begin{itemize}
    \item transition: Calls the deactivate function, then if the asteroid is not small it creates 3 new smaller asteroids, and places them at its center.
    \item exception: None
\end{itemize}

\noindent pass():
\begin{itemize}
    \item transition: Updates all of the asteroids' children, if they have all been destroyed then it removes the children from the game.
    \item exception: None
\end{itemize}

\noindent isDead():
\begin{itemize}
    \item output: False if the asteroid is visible or has children left, or true if the asteroid has no children left or are all dead.
    \item exception: None
\end{itemize}

\noindent getChildren():
\begin{itemize}
    \item output = $out := children$
    \item exception: None
\end{itemize}

\noindent getScale():
\begin{itemize}
    \item output = $out := this.scale$
    \item exception: None
\end{itemize}

\noindent setChildren(children):
\begin{itemize}
    \item input = $in = children \in GameObject[]$
    \item transition = $this.children := children$
    \item exception: None
\end{itemize}

\noindent setScale(scale):
\begin{itemize}
    \item input = $in = scale \in \mathbb{Z}$
    \item transition = $this.scale := scale$
    \item exception: None
\end{itemize}

\noindent add(children):
\begin{itemize}
    \item input = $in = children \in GameObject$
    \item transition = $this.children \Vert children$
    \item exception: None
\end{itemize}


%===================================================

\newpage

\section*{GameState Module}

\subsection*{Uses}

utilities.js, gameobject.js, head.js\\

\subsubsection*{Exported Constants}

STATE=\{START,PREGAME,LOAD,PLAYING,POSTGAME,PAUSE,RELOAD\}\\
StateMachine=?\\

\subsubsection*{Exported Access Programs}

\begin{tabular}{| l | l | l | l |}
    \hline
    \textbf{Routine name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
    \hline
    StateMachine &  & ~ & ~\\
    \hline
    isSafe & OBJECT, seq. of OBJECT & ~ & ~\\
    \hline
    generateAsteroids & $x \in \mathbb{Z}$ & ~ & ~ \\
    \hline
    checkCollision & GameObject, GameObject, GameObject & ~ & ~ \\
    \hline
    togglePause & ~ & ~ & ~ \\
    \hline
\end{tabular}

\subsection* {Semantics}

\subsubsection* {State Variables}

$state$: String
$stateSave$: String
$paused$: $\mathbb{B}$

\subsubsection* {State Invariant}

$state \neq stateSave$

\subsubsection* {Assumptions}

None

%\begin{itemize}
%\end{itemize}

\subsubsection* {Access Routine Semantics}

StateMachine():
\begin{itemize}
    \item transition: $state = \mbox{start}$
    \item output: $out := StateMachine$
    \item exception: None
\end{itemize}

\noindent isSafe(obj,sprites){
\begin{itemize}
  \item input: $in := object, in := sprites$
  \item return: $d := \forall s \in sprites: (\mbox{getName}(s) = "asteroid" \land \mbox{getActivity}(s) = false \land \exists c \in \mbox{getChildren}(s): \lnot \mbox{isSafe}(c): false) \lor (\mbox{getName}(s) = "asteroid" \land \mbox{getActivity}(s) = true: \mbox{checkCollision}(obj, s, 50): false) \lor (\mbox{getName}(s) \in \{"alien, "alienBullet"\} \land \mbox{getActivity}(s) = true \land \mbox{checkCollision}(obj,s,50): false)$
  \item exception: None
\end{itemize}
}

\noindent checkCollision(a,b,c)
\begin{itemize}
  \item input: $a \in \mbox{GameObject}, b \in \mbox{GameObject}, c \in \mathbb{Z}$
  \item output: $out := (pyth(|a.getX - b.getX|, |a.getX - b.getX|) < c)$
  \item exception: None
\end{itemize}

\noindent togglePause():
\begin{itemize}
    \item transition: $ pause \Rightarrow (stateSave = state \land state = \mbox{PAUSE}) \lor \lnot pause \Rightarrow (state = stateSave) $
    \item exception: None
\end{itemize}

\subsection*{Local Functions}

\noindent screenShow: $String\times\{\mbox{NORMAL},\mbox{EMPHASIS}\Rightarrow?\}$
\noindent output: $out := $

\noindent drawShape: $String\times\mathbb{R}\times\mathbb{R}\Rightarrow$
\noindent transition: displays specifed shape at specified position

\noindent Play: $AUDIO$
\noindent transition: Plays specified AUDIO audio file

\noindent pauseSound: $AUDIO$
\noindent transition: Pauses specified AUDIO audio file

\noindent unpauseSound: $AUDIO$
\noindent transition: Unpauses specified AUDIO audio file

\noindent stopSound: $AUDIO$
\noindent transition: Stops specified AUDIO audio file is it was playing



\noindent drawTriangle: $ \mathbb{N} \Rightarrow $
\noindent output: $out := $

\noindent getName: $ \mbox{OBJECT} \Rightarrow $
\noindent output: $out := $

\noindent getActivity: $ \mbox{OBJECT} \Rightarrow $
\noindent output: $out := $

\noindent getChildren: $ \mbox{OBJECT} \Rightarrow $
\noindent output: $out := $




%QUESTIONS GO HERE

% How to deal with: Drawing to screen, printing
% Can a 'refer to JSDoc Documentation' be used for simple getters and setters

\end{document}
